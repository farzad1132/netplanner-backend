openapi: 3.0.0

info:
  version: "1.0.0"
  title: NetPlanner API
  description: First version of NetPlanner API
  contact:
    name: Farzad Mohammadi
    email: farzad.mohammadi87@gmail.com
    
  
servers:   
  - url: /v1
    description: development server of this version
  
  
  - url: /v1_p
    description: production server of this version
    
components:
  securitySchemes:
    jwt:
      type: http
      scheme: bearer
      bearerFormat: JWT
      x-bearerInfoFunc: user.decode_token
  schemas:
    physical_topology:
      type: object
      properties:
        nodes:
          type: array
          items:
            type: object
            properties:
              name:
                type: string
              lat: 
                type: number
                format: float
              lng:
                type: number
                format: float
              roadm_type:
                type: string
            required: 
              - Name
              - lat
              - lng
              - roadm_type
            
        links:
          type: array
          items:
            type: object
            properties:
              source:
                type: string
              destination:
                type: string
              distance:
                type: number
                format: float
              fiber_type:
                type: string
            required: 
              - source
              - destination
              - distance
              - fiber_type
    traffic_matrix:
      type: object
      properties:
        demands: 
          type: array
          items:
            type: object
            properties:
              source:
                type: string
              destination:
                type: string
              id:
                type: integer
              type:
                type: string
              protection_type:
                type: string
              restoration_type:
                type: string
              services:
                type: array
                items:
                  type: object
                  properties:
                    quantity:
                      type: integer
                      format: int32
                    sla:
                      type: string
                    type:
                      type: string
                    granularity:
                      type: string
                    granularity_vc12:
                      type: string
                    granularity_vc4:
                      type: string
                  required: 
                    - type
                    - quantity
            required: 
              - source
              - destination
              - type
              - services
              - protection_type
              - restoration_type
            
    
  parameters:
    id:
      name: id
      in: query
      required: true
      schema:
        type: integer
    user_id:
      name: user_id
      in: path
      required: true
      schema:
        type: integer
      
    
paths:
  /physical_topologies/{user_id}:
    summary: this path is handling Physical Topology interactions
    get:
      tags: 
       - Physical Topology
      summary: Obtaining stored physical topology
      description: With an id you can get a Physical Topology from database
      operationId: PhysicalTopology.get_physical_topology
      parameters: 
        - $ref: '#/components/parameters/id'
        - $ref: '#/components/parameters/user_id'
      responses:
        200:
          description: Physical Topology found
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: '#/components/schemas/physical_topology'
        default:
          description: error handling
          content:
            application/json:
              schema:
                type: object
                properties:
                  error_msg:
                    type: string
                required:
                  - error_msg
                
                
    
    post:
      tags: 
        - Physical Topology
      summary: Creating New Physical Topology
      description: This method creates a Physical Topology with given data and answers 
        with its id
      operationId: PhysicalTopology.create_physical_topology
      parameters:
        - name: name
          in: query
          required: true
          schema:
            type: string
        - $ref: '#/components/parameters/user_id'
      requestBody:
        description: providing information for creating new Physical Topology
        content:
         application/json:
          schema:
            $ref: '#/components/schemas/physical_topology'
            
      responses:
        201:
          description: A new Physical Topology created
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                required: 
                  - id
        default:
          description: error handling
          content:
            application/json:
              schema:
                type: object
                properties:
                  error_msg:
                    type: string
                required:
                  - error_msg
    
    put:
      tags: 
        - Physical Topology
      summary: Updating existing Physical Topology
      description: this method updates any given node or link in a particular Physical Topology
      operationId: PhysicalTopology.update_physical_topology
      parameters: 
        - $ref: '#/components/parameters/id'
        - $ref: '#/components/parameters/user_id'
      requestBody:
        description: provide anything that you want to update
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/physical_topology'
      responses:
        200:
          description: Physical Topology Updated
        default:
          description: error handling
          content:
            application/json:
              schema:
                type: object
                properties:
                  error_msg:
                    type: string
                required:
                  - error_msg
    
    delete:
      tags: 
       - Physical Topology
      summary: Deleting existing Physical Topology
      description: this method deletes corresponding Physical Topology
      operationId: PhysicalTopology.delete_physical_topology
      parameters: 
        - $ref: '#/components/parameters/id'
        - $ref: '#/components/parameters/user_id'
      responses:
        200:
          description: Physical Topology deleted
        
        default:
          description: error handling
          content:
            application/json:
              schema:
                type: object
                properties:
                  error_msg:
                    type: string
                required:
                  - error_msg
  
  /physical_topologies/from_excel/{user_id}:
    post:
      tags:
        - Physical Topology
      summary: creating physical topology with excel file
      operationId: PhysicalTopology.read_from_excel
      parameters:
        - $ref: '#/components/parameters/user_id'
        - name: name
          in: query
          required: true
          schema:
            type: string
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                pt_binary:
                  type: string
                  format: binary
      responses:
        201:
          description: physical_topology in JSON
          content:
            application/json:
              schema:
                type: object
                properties:
                  physical_topology:
                    $ref: '#/components/schemas/physical_topology'
                  id:
                    type: integer
        default:
          description: error handling
          content:
            application/json:
              schema:
                type: object
                properties:
                  error_msg:
                    type: string
                required:
                  - error_msg
          
  /physical_topologies/read_all/{user_id}:
    summary: Reading all physical topologies
    get:
      tags:
        - Physical Topology
      summary: Reading all physical topologies stored in Database
      operationId: PhysicalTopology.read_all_pts
      parameters:
        - $ref: '#/components/parameters/user_id'
      responses:
        200:
          description: Returning back all physical topologies
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    name:
                      type: string
                    id:
                      type: integer
                      format: int64
                    create_date:
                      type: string
                      format: date-time
                  required:
                    - name
                    - id
                    - create_date
        default:
          description: error handling
          content:
            application/json:
              schema:
                type: object
                properties:
                  error_msg:
                    type: string
                required:
                  - error_msg
                
          
  /traffic_matrices/{user_id}:
    summary: This path is handling operations related to Traffic Matrix
    get:
      tags: 
        - Traffic Matrix
      summary: Obtaining stored Traffic Matrix
      description: Accessing a traffic Matrix using it's id
      parameters: 
        - $ref: '#/components/parameters/id'
        - $ref: '#/components/parameters/user_id'
      operationId: TrafficMatrix.get_traffic_matrix
      responses:
        200:
          description: Requested Traffic Matrix found
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: '#/components/schemas/traffic_matrix'
        default:
          description: error handling
          content:
            application/json:
              schema:
                type: object
                properties:
                  error_msg:
                    type: string
                required:
                  - error_msg
            
    
    post:
      tags: 
       - Traffic Matrix
      summary: Creating new Traffic Matrix
      description: This method creates a Traffic Matrix and returns its id
      operationId: TrafficMatrix.create_traffic_matrix
      parameters:
        - name: name
          in: query
          required: true
          schema:
            type: string
        - $ref: '#/components/parameters/user_id'
      requestBody: 
        description: Providing Traffic Matrix information
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/traffic_matrix'
      
      responses:
        201:
          description: Traffic Matrix created
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    format: int64
                required: 
                 - id
    put:
      tags: 
       - Traffic Matrix
      summary: Updating an existing Traffic Matrix
      description: This method updates a Traffic Matrix from database
      parameters: 
        - $ref: '#/components/parameters/id'
        - $ref: '#/components/parameters/user_id'
      operationId: TrafficMatrix.update_traffic_matrix  
      requestBody:
        description: Providing information for updating Traffic Matrix
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/traffic_matrix'
      
      responses:
        200:
          description: Traffic Matrix updated

        default:
          description: error handling
          content:
            application/json:
              schema:
                type: object
                properties:
                  error_msg:
                    type: string
                required:
                  - error_msg
    delete:
      tags: 
       - Traffic Matrix
      summary: Deleting an existing Traffic Matrix
      operationId: TrafficMatrix.delete_traffic_matrix
      description: This method deletes a traffic Matrix from database
      parameters: 
       - $ref: '#/components/parameters/id'
       - $ref: '#/components/parameters/user_id'
      responses:
        200:
          description: Traffic Matrix deleted
  
  /traffic_matrices/from_excel/{user_id}:
    post:
      tags:
        - Traffic Matrix
      summary: creating traffic matrix with excel file
      operationId: TrafficMatrix.read_from_excel
      parameters:
        - $ref: '#/components/parameters/user_id'
        - name: name
          in: query
          required: true
          schema:
            type: string
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                tm_binary:
                  type: string
                  format: binary
      responses:
        201:
          description: traffic_matrix in JSON
          content:
            application/json:
              schema:
                type: object
                properties:
                  traffic_matrix:
                    $ref: '#/components/schemas/traffic_matrix'
                  id:
                    type: integer
        default:
          description: error handling
          content:
            application/json:
              schema:
                type: object
                properties:
                  error_msg:
                    type: string
                required:
                  - error_msg
          
  /traffic_matrices/read_all/{user_id}:
    description: Reading all saved traffic matrices for a user
    get:
      tags:
       - Traffic Matrix
      summary: Reading all Traffic Matrices
      parameters:
        - $ref: '#/components/parameters/user_id'
      operationId: TrafficMatrix.read_all
      responses:
        200:
          description: Returning traffic matrices
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    name:
                      type: string
                    id:
                      type: integer
                      format: int64
                    create_date:
                      type: string
                      format: date-time
                  required:
                    - name
                    - id
                    - date-time
        default:
          description: error handling
          content:
            application/json:
              schema:
                type: object
                properties:
                  error_msg:
                    type: string
                required:
                  - error_msg
          
          
  /clustering/{user_id}:
    summary: This path is handling operations related to Clustering
    post:
      operationId: Clustering.create_Cluster
      summary: Creating clusters
      tags: 
        - Clustering
      description: Creating new cluster in a Physical Topology (use this method if you want to save cluster in database)
      parameters: 
        - name: PhysicalTopologyId
          in: query
          schema:
            type: integer
            format: int64
          required: true
        - $ref: '#/components/parameters/user_id'
      requestBody:
        description: Providing Gateways and Subnodes
        content:
          application/json:
            schema:
              type: object
              properties:
                gateways:
                  type: array
                  items:
                    type: string
                subnodes:
                  type: array
                  items:
                    type: string
      responses:
        201:
          description: Cluster saved in DataBase
          content:
            application/json:
              schema:
                type: object
                properties:
                  cluster_id:
                    type: integer
                    format: int64
                required: 
                  - cluster_id
  /projects/{user_id}:
    summary: This path job is to handle projects
    get:
      description: Accessing a existing Project
      summary: Obtaining stored Project
      tags: 
        - Project
      parameters: 
        - $ref: '#/components/parameters/id'
        - $ref: '#/components/parameters/user_id'
      operationId: Project.read_Project
      responses:
        200:
          description: Sending PT_id, TM_id
          content:
            application/json:
              schema:
                type: object
                properties:
                  tm_id:
                    type: integer
                  pt_id:
                    type: integer
                required:
                  - tm_id
                  - pt_id
                  #results list of id's
        default:
          description: error handling
          content:
            application/json:
              schema:
                type: object
                properties:
                  error_msg:
                    type: string
                required:
                  - error_msg
                
    post:
      description: Creating new project using physical topology, traffic matrix, Cluster id
      summary: Creating new Project
      tags: 
       - Project
      parameters: 
        - name: tm_id
          in: query
          required: true
          schema:
            type: integer
            format: int64
          description: Traffic Matrix id
        
        - name: pt_id
          in: query
          required: true
          schema:
            type: integer
            format: int64
          description: Physical Topology id
        
        - name: clusters_id
          in: query
          schema:
            type: array
            items:
              type: integer
              format: int64
          description: Clusters id
        
        - $ref: '#/components/parameters/user_id'

        - name: name
          in: query
          required: true
          schema:
           type: string
      
      operationId: Project.create_Project
      responses:
        201:
          description: Sending back Project id
          content:
            application/json:
              schema:
                type: object
                properties:
                  project_id:
                    type: integer
                    format: int64
                required: 
                  - project_id
        default:
          description: error handling
          content:
            application/json:
              schema:
                type: object
                properties:
                  error_msg:
                    type: string
                required:
                  - error_msg
    
    put:
      summary: Updating an existing Project
      tags: 
        - Project
      description: Updating Project Using Project_Id
      parameters: 
        - $ref: '#/components/parameters/id'
        - $ref: '#/components/parameters/user_id'

        - name: tm_id
          in: query
          schema:
            type: integer
            format: int64
          description: Traffic Matrix id
        
        - name: pt_id
          in: query
          schema:
            type: integer
            format: int64
          description: Physical Topology id
        
        - name: clusters_id
          in: query
          schema:
            type: array
            items:
              type: integer
              format: int64
          description: Clusters id
        
        - name: name
          in: query
          required: true
          schema:
            type: string
      
      operationId: Project.update_Project
      responses:
        200:
          description: Done
        default:
          description: error handling
          content:
            application/json:
              schema:
                type: object
                properties:
                  error_msg:
                    type: string
                required:
                  - error_msg
    
    delete:
      summary: Deleting an Existing Project
      tags:
        - Project
      parameters:
        - $ref: '#/components/parameters/id'
        - $ref: '#/components/parameters/user_id'
      operationId: Project.delete_Project
      
      responses:
        200:
          description: Project deleted
  /login:
    summary: path for logging in
    get:
      summary: Accessing user_id with username and password
      tags:
        - User
      parameters:
        - name: username
          in: query
          required: true
          schema:
            type: string
        
        - name: password
          in: query
          required: true
          schema:
            type: string
            format: password
      operationId: user.login
      responses:
        200:
          description: User Found
          content:
            application/json:
              schema:
                type: object
                properties:
                  user_id:
                    type: integer
                  token:
                    type: string
        default:
          description: error handling
          content:
            application/json:
              schema:
                type: object
                properties:
                  error_msg:
                    type: string
                required:
                  - error_msg
  
  /projects/read_all/{user_id}:
    summary: path for getting all projects associated with user_id
    get:
      summary: getting all projects
      tags:
        - Project
      parameters:
        - $ref: '#/components/parameters/user_id'
      operationId: Project.read_all
      responses:
        200:
          description: Projects found
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
        default:
          description: error handling
          content:
            application/json:
              schema:
                type: object
                properties:
                  error_msg:
                    type: string
                required:
                  - error_msg

              
      
      
      
      